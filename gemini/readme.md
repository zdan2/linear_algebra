
### セクション1: ベクトルの基本 (課題1 - 20)

このセクションでは、ベクトルの定義、演算、性質についてPython (NumPy) を用いて学びます。

**課題1:** 2次元ベクトル $\vec{a} = (2, 3)$ と $\vec{b} = (4, -1)$ をNumPy配列として作成し、それぞれ表示しなさい。

**課題2:** 課題1で作成したベクトル $\vec{a}$ と $\vec{b}$ の和 $\vec{a} + \vec{b}$ を計算し、結果を表示しなさい。

**課題3:** 課題1で作成したベクトル $\vec{a}$ と $\vec{b}$ の差 $\vec{a} - \vec{b}$ を計算し、結果を表示しなさい。

**課題4:** 課題1で作成したベクトル $\vec{a}$ のスカラー倍 $3\vec{a}$ を計算し、結果を表示しなさい。

**課題5:** 3次元ベクトル $\vec{c} = (1, 2, 3)$ と $\vec{d} = (-1, 0, 2)$ をNumPy配列として作成し、それぞれ表示しなさい。

**課題6:** 課題5で作成したベクトル $\vec{c}$ と $\vec{d}$ の和 $\vec{c} + \vec{d}$ を計算し、結果を表示しなさい。

**課題7:** 課題1で作成したベクトル $\vec{a}$ の大きさ（ノルム） $||\vec{a}||$ を計算し、結果を表示しなさい。NumPyの `np.linalg.norm()` 関数を使ってみましょう。

**課題8:** 課題5で作成したベクトル $\vec{c}$ の大きさ（ノルム） $||\vec{c}||$ を計算し、結果を表示しなさい。

**課題9:** 課題1で作成したベクトル $\vec{a}$ と $\vec{b}$ の内積 $\vec{a} \cdot \vec{b}$ を計算し、結果を表示しなさい。NumPyの `np.dot()` 関数または `@` 演算子を使ってみましょう。

**課題10:** 課題5で作成したベクトル $\vec{c}$ と $\vec{d}$ の内積 $\vec{c} \cdot \vec{d}$ を計算し、結果を表示しなさい。

**課題11:** 2次元ベクトル $\vec{e} = (1, \sqrt{3})$ と $\vec{f} = (\sqrt{3}, 1)$ のなす角 $\theta$ (ラジアン単位) を求め、結果を表示しなさい。内積とノルムの関係式 $\cos\theta = \frac{\vec{e} \cdot \vec{f}}{||\vec{e}|| \cdot ||\vec{f}||}$ と `np.arccos()` を利用しましょう。

**課題12:** 3次元ベクトル $\vec{g} = (1, 0, 0)$ と $\vec{h} = (0, 1, 1)$ のなす角 $\theta$ (度数単位) を求め、結果を表示しなさい。`np.degrees()` を使ってラジアンから度数に変換しましょう。

**課題13:** ベクトル $\vec{i} = (3, 4)$ を正規化（単位ベクトル化）し、結果を表示しなさい。正規化したベクトルの大きさが1になることを確認しなさい。

**課題14:** ベクトル $\vec{j} = (1, -2, 2)$ を正規化し、結果を表示しなさい。

**課題15:**  2つの2次元ベクトルが直交するかどうかを判定するPython関数 `are_orthogonal_2d(v1, v2)` を作成しなさい。この関数は、NumPy配列として与えられた2つのベクトルが直交する場合に `True` を、そうでない場合に `False` を返すものとします。ベクトル $(1, 1)$ と $(1, -1)$ でテストしなさい。

**課題16:** 3つの3次元ベクトル $\vec{u} = (1, 1, 0)$, $\vec{v} = (1, -1, 1)$, $\vec{w} = (-1, 1, 2)$ が互いに直交するかどうかを確認しなさい。

**課題17:** 2次元ベクトル $\vec{p} = (a, b)$ と $\vec{q} = (c, d)$ の外積（正確には外積のz成分、または2次元平面におけるスカラー外積）は $ad - bc$ で与えられます。$\vec{p}=(2,1)$ と $\vec{q}=(3,4)$ の外積を計算しなさい。NumPyの `np.cross()` は3次元ベクトルに対して定義されているため、これらのベクトルを $(a,b,0)$, $(c,d,0)$ とみなして計算するか、直接定義式で計算してください。

**課題18:** 3次元ベクトル $\vec{r} = (1, 2, 3)$ と $\vec{s} = (4, 5, 6)$ の外積 $\vec{r} \times \vec{s}$ を計算し、結果を表示しなさい。NumPyの `np.cross()` 関数を使いましょう。

**課題19:** 課題18で計算した外積ベクトルが、元のベクトル $\vec{r}$ および $\vec{s}$ の両方と直交することを確認しなさい（内積が0になることを示す）。

**課題20:** NumPyを使い、要素が0から9までの整数である1次元配列（ベクトル）を作成し表示しなさい。 `np.arange()` を使ってみましょう。

-----

### セクション2: 行列の基本 (課題21 - 45)

このセクションでは、行列の定義、演算、基本的な性質についてPython (NumPy) を用いて学びます。

**課題21:** $2 \times 3$ 行列 $A = \begin{pmatrix} 1 & 2 & 3 \\ 4 & 5 & 6 \end{pmatrix}$ をNumPy配列として作成し、表示しなさい。

**課題22:** $3 \times 2$ 行列 $B = \begin{pmatrix} 7 & 8 \\ 9 & 1 \\ 2 & 3 \end{pmatrix}$ をNumPy配列として作成し、表示しなさい。

**課題23:** 課題21で作成した行列 $A$ の形状（shape）、次元数（ndim）、要素のデータ型（dtype）を表示しなさい。

**課題24:** 要素が全て0である $3 \times 3$ の零行列を作成し、表示しなさい。NumPyの `np.zeros()` を使いましょう。

**課題25:** 要素が全て1である $2 \times 4$ の行列を作成し、表示しなさい。NumPyの `np.ones()` を使いましょう。

**課題26:** $3 \times 3$ の単位行列 $I$ を作成し、表示しなさい。NumPyの `np.eye()` または `np.identity()` を使いましょう。

**課題27:** $2 \times 2$ 行列 $M = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}$ と $N = \begin{pmatrix} 5 & 6 \\ 7 & 8 \end{pmatrix}$ をNumPy配列として作成しなさい。

**課題28:** 課題27で作成した行列 $M$ と $N$ の和 $M + N$ を計算し、結果を表示しなさい。

**課題29:** 課題27で作成した行列 $M$ と $N$ の差 $M - N$ を計算し、結果を表示しなさい。

**課題30:** 課題27で作成した行列 $M$ のスカラー倍 $2M$ を計算し、結果を表示しなさい。

**課題31:** 課題27で作成した行列 $M$ と $N$ の要素ごとの積（アダマール積）を計算し、結果を表示しなさい。（NumPyでは `*` 演算子で計算できます）

**課題32:** 課題27で作成した行列 $M$ と $N$ の行列としての積 $MN$ を計算し、結果を表示しなさい。NumPyの `np.dot()` または `@` 演算子を使いましょう。

**課題33:** 課題21の行列 $A$ と課題22の行列 $B$ の積 $AB$ を計算し、結果を表示しなさい。

**課題34:** 課題21の行列 $A$ の転置行列 $A^T$ を計算し、結果を表示しなさい。NumPy配列の `.T` 属性または `np.transpose()` 関数を使いましょう。

**課題35:** 課題27の行列 $M$ の転置行列 $M^T$ を計算し、結果を表示しなさい。

**課題36:** 対角要素が $(1, 2, 3)$ である $3 \times 3$ の対角行列を作成し、表示しなさい。NumPyの `np.diag()` を使いましょう。

**課題37:** 行列 $P = \begin{pmatrix} 1 & 2 & 3 \\ 4 & 5 & 6 \\ 7 & 8 & 9 \end{pmatrix}$ をNumPy配列として作成しなさい。

**課題38:** 課題37で作成した行列 $P$ の $(2, 3)$ 要素（2行目、3列目の要素、値は6）にアクセスし、表示しなさい（インデックスは0から始まることに注意）。

**課題39:** 課題37で作成した行列 $P$ の1行目の全要素（ベクトル）をスライスして取り出し、表示しなさい。

**課題40:** 課題37で作成した行列 $P$ の2列目の全要素（ベクトル）をスライスして取り出し、表示しなさい。

**課題41:** 課題37で作成した行列 $P$ の中央の $2 \times 2$ の部分行列 $\begin{pmatrix} 5 & 6 \\ 8 & 9 \end{pmatrix}$ をスライスして取り出し、表示しなさい。

**課題42:** 乱数の要素を持つ $3 \times 4$ 行列を生成し表示しなさい。NumPyの `np.random.rand()` または `np.random.randn()` を使いましょう。

**課題43:** 行列 $Q = \begin{pmatrix} 1 & -1 \\ -1 & 1 \end{pmatrix}$ とベクトル $\vec{v} = \begin{pmatrix} 2 \ 3 \end{pmatrix}$ をNumPy配列として作成し、行列とベクトルの積 $Q\vec{v}$ を計算し、結果を表示しなさい。

**課題44:** 課題37の行列 $P$ と $3 \times 3$ の単位行列 $I$ の積 $PI$ および $IP$ を計算し、結果が $P$ と同じになることを確認しなさい。

**課題45:** 上三角行列と下三角行列の例をそれぞれ1つずつ $3 \times 3$ で作成し、表示しなさい。NumPyの `np.triu()` と `np.tril()` が利用できますが、まずは手動で定義してみましょう。

-----

### セクション3: 行列式と逆行列 (課題46 - 60)

このセクションでは、正方行列の行列式と逆行列の計算方法とその性質について学びます。

**課題46:** $2 \times 2$ 行列 $A = \begin{pmatrix} a & b \\ c & d \end{pmatrix}$ の行列式は $ad - bc$ で計算されます。行列 $M = \begin{pmatrix} 3 & 1 \\ 2 & 4 \end{pmatrix}$ の行列式をこの定義に従って計算し、結果を表示しなさい。

**課題47:** 課題46の行列 $M$ の行列式をNumPyの `np.linalg.det()` 関数を使って計算し、結果が一致することを確認しなさい。

**課題48:** $3 \times 3$ 行列 $B = \begin{pmatrix} 1 & 2 & 3 \\ 0 & 4 & 5 \\ 1 & 0 & 6 \end{pmatrix}$ の行列式をNumPyの `np.linalg.det()` 関数を使って計算し、結果を表示しなさい。

**課題49:** 行列式が0になる $2 \times 2$ 行列の例を1つ作成し、その行列式を計算して0になることを確認しなさい。（ヒント: ある行が別の行の定数倍になっている場合など）

**課題50:** $2 \times 2$ 行列 $A = \begin{pmatrix} a & b \\ c & d \end{pmatrix}$ の逆行列は、行列式 $\det(A) = ad-bc \neq 0$ のとき、$A^{-1} = \frac{1}{ad-bc} \begin{pmatrix} d & -b \\ -c & a \end{pmatrix}$ で与えられます。行列 $M = \begin{pmatrix} 3 & 1 \\ 2 & 4 \end{pmatrix}$ （課題46）の逆行列をこの定義に従って計算し、結果を表示しなさい。

**課題51:** 課題50で計算した逆行列 $M^{-1}$ と元の行列 $M$ の積 $MM^{-1}$ および $M^{-1}M$ を計算し、どちらも単位行列になることを確認しなさい。

**課題52:** 課題46の行列 $M$ の逆行列をNumPyの `np.linalg.inv()` 関数を使って計算し、課題50の結果と一致することを確認しなさい。

**課題53:** 課題48の行列 $B$ の逆行列をNumPyの `np.linalg.inv()` 関数を使って計算し、結果を表示しなさい。

**課題54:** 課題53で計算した逆行列 $B^{-1}$ と元の行列 $B$ の積 $BB^{-1}$ を計算し、単位行列（に近い行列、浮動小数点誤差を考慮）になることを確認しなさい。

**課題55:** 逆行列を持たない（行列式が0の） $2 \times 2$ 行列（例えば課題49で作成した行列）に対してNumPyの `np.linalg.inv()` を実行しようとするとどうなるか確認しなさい。（エラーが発生するはずです）

**課題56:** $(AB)^{-1} = B^{-1}A^{-1}$ という性質があります。$2 \times 2$ 行列 $A = \begin{pmatrix} 1 & 2 \\ 0 & 1 \end{pmatrix}$ と $B = \begin{pmatrix} 2 & 0 \\ 1 & 3 \end{pmatrix}$ について、$(AB)^{-1}$ と $B^{-1}A^{-1}$ をそれぞれ計算し、結果が一致することを確認しなさい。

**課題57:** $(A^T)^{-1} = (A^{-1})^T$ という性質があります。課題56の行列 $A$ について、$(A^T)^{-1}$ と $(A^{-1})^T$ をそれぞれ計算し、結果が一致することを確認しなさい。

**課題58:** 対角行列 $D = \begin{pmatrix} d\_1 & 0 & 0 \\ 0 & d\_2 & 0 \\ 0 & 0 & d\_3 \end{pmatrix}$ （ただし $d\_1, d\_2, d\_3 \neq 0$）の逆行列は $D^{-1} = \begin{pmatrix} 1/d\_1 & 0 & 0 \\ 0 & 1/d\_2 & 0 \\ 0 & 0 & 1/d\_3 \end{pmatrix}$ となります。具体的な対角行列（例: $d\_1=1, d\_2=2, d\_3=3$）でこれを確認しなさい。NumPyで計算して確かめてみましょう。

**課題59:** ある行列とその転置行列の行列式は等しい、つまり $\det(A) = \det(A^T)$ です。$3 \times 3$ 行列 $C = \begin{pmatrix} 1 & 0 & 2 \\ -1 & 3 & 0 \\ 2 & 1 & 4 \end{pmatrix}$ でこれを確認しなさい。

**課題60:** 行列の積の行列式は、それぞれの行列式の積に等しい、つまり $\det(AB) = \det(A)\det(B)$ です。課題56の行列 $A$ と $B$ でこれを確認しなさい。

-----

### セクション4: 連立一次方程式 (課題61 - 75)

このセクションでは、連立一次方程式を行列を用いて表現し、Python (NumPy) を使って解く方法を学びます。

**課題61:** 連立一次方程式
$$ \begin{cases} 2x + y = 5 \\ x - 3y = -1 \end{cases} $$
を行列とベクトルを用いて $A\vec{x} = \vec{b}$ の形に表し、係数行列 $A$ と定数ベクトル $\vec{b}$ をNumPy配列として作成しなさい。

**課題62:** 課題61の連立一次方程式を、逆行列 $A^{-1}$ を用いて $\vec{x} = A^{-1}\vec{b}$ として解き、解 $\vec{x} = (x, y)$ を表示しなさい。

**課題63:** 課題61の連立一次方程式をNumPyの `np.linalg.solve(A, b)` 関数を使って解き、結果が課題62と一致することを確認しなさい。

**課題64:** 連立一次方程式
$$ \begin{cases} x + y + z = 6 \\ 2y + 5z = -4 \\ 2x + 5y - z = 27 \end{cases} $$
を $A\vec{x} = \vec{b}$ の形に表し、係数行列 $A$ と定数ベクトル $\vec{b}$ をNumPy配列として作成し、`np.linalg.solve()` を使って解 $\vec{x} = (x, y, z)$ を求めなさい。

**課題65:** 課題64で求めた解が正しいか、元の連立一次方程式に代入して（つまり $A\vec{x}$ を計算して $\vec{b}$ と比較して）確認しなさい。

**課題66:** 解が一意に定まらない（不定または不能な）連立一次方程式の例を考えます。
$$ \begin{cases} x + y = 2 \\ 2x + 2y = 4 \end{cases} $$
この係数行列 $A$ を作成し、その行列式を計算しなさい。行列式が0になることを確認してください。

**課題67:** 課題66の方程式系に対して `np.linalg.solve()` を使おうとするとどうなるか確認しなさい。（エラーが発生するはずです。これは行列 $A$ が特異行列であるためです。）

**課題68:** 解が存在しない（不能な）連立一次方程式の例を考えます。
$$ \begin{cases} x + y = 2 \\ x + y = 3 \end{cases} $$
この係数行列 $A$ と定数ベクトル $\vec{b}$ を作成し、`np.linalg.solve()` を試みてください。

**課題69:** 斉次連立一次方程式（右辺の定数項が全て0の方程式系、すなわち $A\vec{x} = \vec{0}$）は、自明な解 $\vec{x} = \vec{0}$ を持ちます。係数行列 $A = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}$ と $\vec{b} = \begin{pmatrix} 0 \ 0 \end{pmatrix}$ に対して `np.linalg.solve(A, b)` を実行し、自明な解が得られることを確認しなさい。

**課題70:** 斉次連立一次方程式 $A\vec{x} = \vec{0}$ が非自明な解（$\vec{x} \neq \vec{0}$）を持つための必要十分条件は $\det(A) = 0$ です。係数行列 $A = \begin{pmatrix} 1 & 2 \\ 2 & 4 \end{pmatrix}$ （$\det(A)=0$）の場合、非自明な解が存在します。この方程式系 $x + 2y = 0, 2x + 4y = 0$ の解を（手計算で）見つけ、それが実際に解であることを確認しなさい。

**課題71:** NumPyを使って最小二乗解を求めることができます。これは $A\vec{x}=\vec{b}$ が解を持たない場合に、「最も近い」解を見つける方法です。`np.linalg.lstsq(A, b, rcond=None)[0]` を使って、課題68の方程式系（$x+y=2, x+y=3$）の最小二乗解を求めてみましょう。係数行列 $A = \begin{pmatrix} 1 & 1 \\ 1 & 1 \end{pmatrix}$, $\vec{b} = \begin{pmatrix} 2 \ 3 \end{pmatrix}$ とします。

**課題72:** 3つの点 $(0,1), (1,2), (2,4)$ を通るような直線 $y = mx+c$ を見つけたいとします。これは、以下の連立方程式の最小二乗解を求める問題と考えることができます。
$ \begin{cases} c + 0m = 1 \ c + 1m = 2 \ c + 2m = 4 \end{cases} $
すなわち $A \begin{pmatrix} c \ m \end{pmatrix} = \vec{b}$ の形で、 $A = \begin{pmatrix} 1 & 0 \\ 1 & 1 \\ 1 & 2 \end{pmatrix}$, $\vec{b} = \begin{pmatrix} 1 \ 2 \ 4 \end{pmatrix}$ です。この最小二乗解 $(c, m)$ を `np.linalg.lstsq()` を使って求めなさい。

**課題73:** 4つの変数を持つ連立一次方程式の例を作成し、$A\vec{x}=\vec{b}$ の形で表現し、NumPyを使って解きなさい。解が一意に定まるように係数行列を選んでください。

**課題74:** ある連立一次方程式 $A\vec{x}=\vec{b}$ が与えられたとき、その拡大係数行列 $[A | \vec{b}]$ をNumPyで作成する方法を考え、表示しなさい。例えば、課題61の $A$ と $\vec{b}$ を使ってみましょう。`np.concatenate()` や `np.hstack()` が使えます。

**課題75:** ガウスの消去法（掃き出し法）は連立一次方程式を解くための基本的なアルゴリズムです。NumPyには直接ガウスの消去法をステップごとに実行する関数はありませんが、`np.linalg.solve()` は内部で効率的なアルゴリズム（LU分解など）を使用しています。ガウスの消去法の考え方について（手計算で）確認できるような簡単な $2 \times 2$ または $3 \times 3$ の例題を自分で設定し、解いてみてください。（この課題はPython実装は任意ですが、概念の理解を目的とします）

-----

### セクション5: 線形独立と基底 (課題76 - 85)

このセクションでは、ベクトルの線形独立性、基底、次元といった概念について学びます。

**課題76:** 2つの2次元ベクトル $\vec{v\_1} = (1, 2)$ と $\vec{v\_2} = (2, 4)$ が線形従属である（一方が他方のスカラー倍で表せる）ことを示しなさい。具体的には、$c\_1\vec{v\_1} + c\_2\vec{v\_2} = \vec{0}$ を満たす自明でないスカラーの組 $(c\_1, c\_2)$ を見つけなさい。

**課題77:** 2つの2次元ベクトル $\vec{u\_1} = (1, 0)$ と $\vec{u\_2} = (0, 1)$ が線形独立であることを（背理法などを使って）説明しなさい。

**課題78:** 複数のベクトルが線形独立であるかどうかを判定する一つの方法は、それらのベクトルを列ベクトルとする行列を作り、その行列のランク（階数）を調べることです。ベクトルが $n$ 個あり、各ベクトルが $m$ 次元の場合、それらを列とする $m \times n$ 行列を作ります。これらのベクトルが線形独立であるための必要十分条件は、この行列のランクが $n$ であることです。
ベクトル $\vec{a}=(1,0,1)$, $\vec{b}=(0,1,1)$, $\vec{c}=(1,1,2)$ は線形従属です（$\vec{c} = \vec{a} + \vec{b}$）。これらを列とする行列 $M = \begin{pmatrix} 1 & 0 & 1 \\ 0 & 1 & 1 \\ 1 & 1 & 2 \end{pmatrix}$ のランクをNumPyの `np.linalg.matrix_rank()` を使って計算し、列の数（3）より小さいことを確認しなさい。

**課題79:** ベクトル $\vec{x}=(1,2,3)$, $\vec{y}=(0,1,2)$, $\vec{z}=(0,0,1)$ が線形独立であるかを確認するために、これらを列とする行列を作成し、そのランクを計算しなさい。ランクが列の数と一致すれば線形独立です。

**課題80:** $R^2$（2次元実数ベクトル空間）の標準基底は $\vec{e\_1}=(1,0)$ と $\vec{e\_2}=(0,1)$ です。ベクトル $\vec{v}=(3,5)$ をこの標準基底の線形結合で表しなさい（つまり、$c\_1\vec{e\_1} + c\_2\vec{e\_2} = \vec{v}$ となる $c\_1, c\_2$ を求めなさい）。

**課題81:** $R^2$ の別の基底として $\vec{b\_1}=(1,1)$ と $\vec{b\_2}=(1,-1)$ が考えられます。これらのベクトルが線形独立であることを確認しなさい（課題78または79の方法で）。

**課題82:** 課題81の基底 ${\vec{b\_1}, \vec{b\_2}}$ に関して、標準基底のベクトル $\vec{e\_1}=(1,0)$ を線形結合で表しなさい。つまり、$c\_1\vec{b\_1} + c\_2\vec{b\_2} = \vec{e\_1}$ となる $c\_1, c\_2$ を求めなさい。これは連立一次方程式を解く問題になります。

**課題83:** $R^3$（3次元実数ベクトル空間）の次元は3です。線形独立な3つの3次元ベクトルは $R^3$ の基底を形成します。課題79のベクトル $\vec{x},\vec{y},\vec{z}$ が $R^3$ の基底となることを述べなさい。

**課題84:** 4つの3次元ベクトルは必ず線形従属になります。具体的な例として、$\vec{v\_1}=(1,0,0), \vec{v\_2}=(0,1,0), \vec{v\_3}=(0,0,1), \vec{v\_4}=(1,1,1)$ を考え、これらを列とする行列のランクを計算し、列の数（4）より小さいことを確認することで線形従属であることを示しなさい。

**課題85:** ある行列の列空間の次元は、その行列のランクと等しくなります。行列 $A = \begin{pmatrix} 1 & 0 & 1 \\ 0 & 1 & 1 \\ 1 & 1 & 2 \end{pmatrix}$ （課題78）の列空間の次元（つまりランク）を求めなさい。

-----

### セクション6: 線形写像 (課題86 - 90)

このセクションでは、線形写像とその行列表現について学びます。

**課題86:** 2次元のベクトル $\vec{x} = (x, y)$ を $(x+y, x-y)$ に写す写像 $T$ を考えます。この写像 $T$ が線形写像であるための条件（$T(\vec{u}+\vec{v}) = T(\vec{u}) + T(\vec{v})$ と $T(c\vec{u}) = cT(\vec{u})$）を満たすことを確認しなさい（代数的に）。

**課題87:** 課題86の線形写像 $T$ の表現行列 $A$ を求めなさい。表現行列は、$T(\vec{e\_1})$ と $T(\vec{e\_2})$ を列ベクトルとして並べたものになります。ここで $\vec{e\_1}=(1,0)$, $\vec{e\_2}=(0,1)$ は標準基底です。求めた行列 $A$ を使って、ベクトル $\vec{v}=(2,3)$ の写像後のベクトル $A\vec{v}$ を計算しなさい。

**課題88:** $R^2$ から $R^2$ への線形写像で、x軸に関して対称移動する写像の表現行列を求めなさい。この行列を使ってベクトル $(1,2)$ を写像し、結果が $(1,-2)$ になることを確認しなさい。

**課題89:** $R^2$ から $R^2$ への線形写像で、原点を中心に $\theta$ 回転する写像の表現行列は $R\_\theta = \begin{pmatrix} \cos\theta & -\sin\theta \ \sin\theta & \cos\theta \end{pmatrix}$ です。$\theta = \pi/2$ (90度) 回転する行列を作成し、ベクトル $(1,0)$ を写像して結果が $(0,1)$ になることを確認しなさい。NumPyの `np.cos()` と `np.sin()` を使いましょう。

**課題90:** 2つの線形写像 $F$ と $G$ があり、それぞれの表現行列が $A$ と $B$ であるとします。合成写像 $F \circ G$ ( $G$ を適用した後に $F$ を適用する) の表現行列は積 $AB$ で与えられます。
$F$ がx軸対称（課題88の行列）、$G$ が90度回転（課題89の行列）であるとき、合成写像 $F \circ G$ の表現行列を計算し、ベクトル $(1,1)$ に適用した結果を求めなさい。また、$G \circ F$ の表現行列も計算し、結果が異なる場合があることを確認しなさい。

-----

### セクション7: 固有値と固有ベクトル (課題91 - 100)

このセクションでは、正方行列の固有値と固有ベクトルの計算と、その意味について学びます。

**課題91:** 行列 $A = \begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix}$ について、ベクトル $\vec{v\_1} = \begin{pmatrix} 1 \ 1 \end{pmatrix}$ が固有ベクトルであるかを確認しなさい。つまり $A\vec{v\_1} = \lambda\_1 \vec{v\_1}$ となる固有値 $\lambda\_1$ を求めなさい。

**課題92:** 課題91の行列 $A$ について、ベクトル $\vec{v\_2} = \begin{pmatrix} 1 \ -1 \end{pmatrix}$ が固有ベクトルであるかを確認し、対応する固有値 $\lambda\_2$ を求めなさい。

**課題93:** 行列 $A = \begin{pmatrix} 4 & 1 \\ 2 & 3 \end{pmatrix}$ の固有値と固有ベクトルをNumPyの `np.linalg.eig()` 関数を使って計算しなさい。この関数は固有値の配列と、固有ベクトルを列として持つ行列を返します。

**課題94:** 課題93で求めた最初の固有値 $\lambda\_1$ と対応する固有ベクトル $\vec{v\_1}$ について、$A\vec{v\_1} = \lambda\_1 \vec{v\_1}$ が（浮動小数点誤差を考慮して）成り立っていることを確認しなさい。

**課題95:** 対角行列 $D = \begin{pmatrix} 2 & 0 & 0 \\ 0 & -1 & 0 \\ 0 & 0 & 5 \end{pmatrix}$ の固有値と固有ベクトルを求めなさい。（これは手計算でも容易ですが、NumPyでも確認してください。）対角行列の固有値は対角成分であり、対応する固有ベクトルは標準基底ベクトルとなることを確認しましょう。

**課題96:** 行列 $B = \begin{pmatrix} 0 & -1 \\ 1 & 0 \end{pmatrix}$ （これは原点を中心とする90度回転の表現行列です）の固有値をNumPyを使って計算しなさい。実数行列でも固有値が複素数になる場合があることを確認しましょう。

**課題97:** 対称行列（$A = A^T$ を満たす行列）の固有値は常に実数であり、異なる固有値に対応する固有ベクトルは直交します。課題91の行列 $A$ は対称行列です。その固有ベクトル $\vec{v\_1}$ と $\vec{v\_2}$ が直交すること（内積が0であること）を確認しなさい。

**課題98:** ある行列 $A$ が固有値 $\lambda$ と固有ベクトル $\vec{v}$ を持つとき、$A^2$ の固有値と固有ベクトルはどうなるでしょうか。$A^2\vec{v} = A(A\vec{v}) = A(\lambda\vec{v}) = \lambda(A\vec{v}) = \lambda(\lambda\vec{v}) = \lambda^2\vec{v}$ となります。つまり、$A^2$ は固有値 $\lambda^2$ と同じ固有ベクトル $\vec{v}$ を持ちます。
課題91の行列 $A$ とその固有値・固有ベクトルを使って、この関係が成り立っているか数値的に確認しなさい。（$A^2$ を計算し、その固有値を `np.linalg.eig()` で求め、元の固有値の2乗と比較する、など）

**課題99:** 行列 $A$ の行列式 $\det(A)$ は、その固有値の積に等しくなります。また、行列 $A$ のトレース（対角成分の和） $\text{tr}(A)$ は、その固有値の和に等しくなります。
課題93の行列 $A = \begin{pmatrix} 4 & 1 \\ 2 & 3 \end{pmatrix}$ について、行列式とトレースを計算し、NumPyで求めた固有値の積と和とそれぞれ比較して、この性質を確認しなさい。

**課題100:** 行列の対角化について考えます。行列 $A$ が $n$ 個の線形独立な固有ベクトルを持つ場合、$A$ は $A = PDP^{-1}$ と対角化可能です。ここで $P$ は固有ベクトルを列とする行列、$D$ は対応する固有値を対角成分に持つ対角行列です。
課題91の行列 $A = \begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix}$ について、固有ベクトルから $P$ を、固有値から $D$ を作成し、$PDP^{-1}$ を計算して元の $A$ と一致するか（または非常に近いか）確認しなさい。$P^{-1}$ は `np.linalg.inv(P)` で計算できます。

